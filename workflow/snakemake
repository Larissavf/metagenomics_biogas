

rule minionqc:
    input:
        fastq_b='/commons/Themas/Thema07/metagenomics/biogas/TBR_M3_B2/Boven2/20220728_1612_MN36331_FAT64465_c641c8e0/fastq/pass/{sample_b}.fastq',
        fastq_m='/commons/Themas/Thema07/metagenomics/biogas/TBR_M3_B2/Midden3/20220728_1612_MN28083_FAT74352_83059c82/fastq/pass/{sample_m}.fastq',
        fastq_p='/commons/Themas/Thema07/metagenomics/biogas/TBR_P2_O1/Pacques2/20220727_1357_MN28083_FAT74352_1c4d8c39/fastq/pass/{sample_p}.fastq',
        fastq_o='/commons/Themas/Thema07/metagenomics/biogas/TBR_P2_O1/Onder1/20220727_1357_MN36331_FAT64465_a35d4b1f/fastq/pass/{sample_o}.fastq'

    output:
        'minionqc_output/'

    params:
        r_script='miniqc.R',
        qscore_cutoff=13

    script:
        """
        library(MinionQC)

       
        fastq_b <- "{input.fastq_b}"
        fastq_m <- "{input.fastq_m}"
        fastq_p <- "{input.fastq_p}"
        fastq_o <- "{input.fastq_o}"
        
        output_dir <- "{output}"

        MinionQC(fastq_b, output_dir, qscore_cutoff={params.qscore_cutoff})
        MinionQC(fastq_m, output_dir, qscore_cutoff={params.qscore_cutoff})
        MinionQC(fastq_p, output_dir, qscore_cutoff={params.qscore_cutoff})
        MinionQC(fastq_o, output_dir, qscore_cutoff={params.qscore_cutoff})
        """

         
         
         ' 

















rule all:
    input:
        expand('/students/2023-2024/Thema07/biogas/qc/fastqc/b_{sample_b}.html', sample_b = SAMPLES_b)
        expand('/students/2023-2024/Thema07/biogas/qc/fastqc/m_{sample_m}.html', sample_m = SAMPLES_m)
        expand('/students/2023-2024/Thema07/biogas/qc/fastqc/p_{sample_p}.html', sample_p = SAMPLES_p)
        expand('/students/2023-2024/Thema07/biogas/qc/fastqc/o_{sample_o}.html', sample_o = SAMPLES_o)


rule fastqc:
    input:
        '/commons/Themas/Thema07/metagenomics/biogas/TBR_M3_B2/Boven2/20220728_1612_MN36331_FAT64465_c641c8e0/fastq/pass/{sample_b}.fastq'
        '/commons/Themas/Thema07/metagenomics/biogas/TBR_M3_B2/Midden3/20220728_1612_MN28083_FAT74352_83059c82/fastq/pass/{sample_m}.fastq'
        '/commons/Themas/Thema07/metagenomics/biogas/TBR_P2_O1/Pacques2/20220727_1357_MN28083_FAT74352_1c4d8c39/fastq/pass/{sample_p}.fastq'
        '/commons/Themas/Thema07/metagenomics/biogas/TBR_P2_O1/Onder1/20220727_1357_MN36331_FAT64465_a35d4b1f/fastq/pass/{sample_o}.fastq'

    output:
        '/students/2023-2024/Thema07/biogas/qc/fastqc/b_{sample_b}.html'
        '/students/2023-2024/Thema07/biogas/qc/fastqc/m_{sample_m}.html'
        '/students/2023-2024/Thema07/biogas/qc/fastqc/p_{sample_p}.html'
        '/students/2023-2024/Thema07/biogas/qc/fastqc/o_{sample_o}.html'

    shell:
        'fastqc {input} --outdir /students/2023-2024/Thema07/biogas/qc/fastqc/'
